<p id="notice"><%= notice %></p>

<% if current_user  == @user %>
  <%= link_to "Edit profile", edit_user_path(current_user)%>

  <%= link_to 'Delete', @user, method: :delete, data: { confirm: 'Are you sure?' } %>
<% end %>
<%= link_to 'Back', root_path %>
<h1 class="user-games"> <%= @user.name %> </h1>

<table class="table table-striped table-hover user-games">
  <tbody >
  <thead>
    <th class='column-title'>Games</th>
    <th class='column-title'>Victories</th>
    <th class='column-title'>Rating</th>
  </thead>
  <tr>
    <td><%= @user.games_played %></td>
    <td><%= @user.games_won %></td>
    <td><%= @user.current_rating %></td>
  </tr>
  </tbody>
</table>

<table class="table table-striped table-hover user-games">
  <tbody>
<br>
  <h4 class="user-games">Active Games</h4>
  <thead>
    <th class='column-title'>Me</th>
    <th class='column-title'>Opponent</th>
    <th class='column-title'>To Move</th>
    <th class='column-title'>Phase</th>
    <th class='column-title'>Moves</th>
    <th class='column-title'>Join Game</th>
  </thead>
    <% @user.games.each do |game| %> 
    <tr data-link="<%= game %>">
      <% if game.active == true && game.users.count == 2%>
        <% game.users.each do |user| %>
            <td><%= user.name %>  </td> 
          <% end %>
          <td><%= game.turnstate %>  </td>
          <td><%= game.phase %>  </td>
          <td><%= game.moves_counter %>  </td>

          <td><%= link_to 'See Game', game %>  </td>
      <% elsif game.active == true %>
        <% game.users.each do |user| %>
            <td><%= user.name %>  </td> 
            <td>Waiting for player </td> 
        <% end %>
          <td><%= game.turnstate %>  </td>
          <td><%= game.phase %>  </td>
          <td><%= game.moves_counter %>  </td>
          <td><%= link_to 'See Game', game %>  </td>

      <% end %>

    </tr>
    <% end %>


  </tbody>
</table>


